% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{ragged2e}
\usepackage{tikz}
\usepackage{wallpaper}
\usepackage{hyperref}
\usepackage{pdflscape}
\usepackage{everypage}





% Set page size with a wider right margin
\geometry{a4paper, total={170mm,257mm}, left=20mm, top=25mm, bottom=20mm, right=20mm}

%% Let's define some colours
\definecolor{light}{HTML}{033F85}
\definecolor{highlight}{HTML}{E42313}
\definecolor{dark}{HTML}{000000}
\definecolor{titlecolor}{HTML}{000000}
% \definecolor{textcolor}{HTML}{383838}

% %% Style the page number
% \fancypagestyle{mystyle}{
%   \fancyhf{}
%   \renewcommand\headrulewidth{0pt}
%   \fancyfoot[C]{\color{dark}\thepage}
%   \fancyfootoffset{-0.5cm}
% }
% \setlength{\footskip}{20pt}

%% Use some custom fonts
\setsansfont{OpenSans}[
  Path=suport/Open/,
  Scale=0.9,
  Extension = .ttf,
  UprightFont=*-Regular,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
]

\setmainfont{OpenSans}[
  Path=suport/Open/,
  Scale=0.9,
  Extension = .ttf,
  UprightFont=*-Regular,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  Color=textcolor,
]

\newfontfamily\playfair{PlayfairDisplay}[
  Path=suport/PlayfairDisplay/,
  Scale=0.9,
  Extension = .ttf,
  UprightFont=*-Regular,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  Color=titlecolor,
]

%% style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{16}{16.8}\playfair} % reduced size
\sectionfont{\color{dark}\fontsize{14}{14.8}\playfair} % changed color to textcolor
\subsectionfont{\color{dark}\fontsize{12}{12.8}\playfair} % changed color to textcolor
\subsubsectionfont{\color{dark}\fontsize{11}{11.8}\playfair} % changed color to textcolor

% Numbering depth for sections and subsections
% 0 means no section numbers,
% 1 means it stops at sections,
% 2 means it stops at subsections, etc.
% Here we set it to 3 so that sections, subsections and subsubsections are numbered.
\setcounter{secnumdepth}{3}

%% Add a header with logo and text
\fancypagestyle{plain}{
  % \geometry{a4paper, total={170mm,257mm}, left=20mm, top=25mm, bottom=20mm, right=20mm}
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \lhead{\begin{minipage}[c]{2.5cm} % logo box, changed alignment to center (c)
    \includegraphics[width=2.5cm]{suport/logo.png} % ensure your logo.png is in the same directory as your .tex file or provide the correct relative path
  \end{minipage}
  \hspace*{0.3cm}% space between logo and vertical line
  {\color{dark}\vrule width 0.5pt}% vertical line
  \hspace*{0.3cm}
  \begin{minipage}[c]{11cm}
    \definecolor{dark}{HTML}{000000}
    {\normalsize\playfair\color{dark} Assurance of Learning} \\
    {\small\normalfont\bfseries\color{dark} 2023/2024}
  \end{minipage}
  \vspace*{0.1cm}
  % {\color{dark}\hrule height 0.5pt width \textwidth}
  % \vspace*{0.5cm}
}
\definecolor{textcolor}{HTML}{383838}
  \fancyfoot[C]{\color{dark}\thepage}
  \fancyfootoffset{-0.5cm}
  \setlength{\footskip}{20pt}
\hypersetup{
  colorlinks = true,
  linkcolor = blue,  % Blue color for hyperlinks
  urlcolor = blue,   % Blue color for URLs
  citecolor = blue   % Blue color for citations
}
\setlength{\headsep}{1.2cm}
}



\fancypagestyle{landscapeplain}{
  \fancyhf{} % Clear header and footer
  \renewcommand{\headrulewidth}{0pt} % remove the header rule
    \renewcommand{\footrulewidth}{0pt} % remove the footer rule
    
    % Redefine margins for this page style
    \newgeometry{
        landscape,
        left=1cm,
        right=0cm,
        top=8.5cm,
        bottom=2.5cm
    }
  % \fancyfoot[C]{\color{dark}\thepage} % Centered page number
  % \fancyfootoffset{-0.5cm}
  \setlength{\footskip}{10pt}
  
  % Set reduced margins for landscape
   % Adjust these values as needed

  \renewcommand\headrulewidth{0pt} % No header line
  \hypersetup{
    colorlinks = true,
    linkcolor = blue, % Blue color for hyperlinks
    urlcolor = blue,  % Blue color for URLs
    citecolor = blue  % Blue color for citations
  }
  
  % \newcommand{\Lpagenumber}{\ifdim\textwidth=\linewidth\else\bgroup
  % \dimendef\margin=0 %use \margin instead of \dimen0
  % \ifodd\value{page}\margin=\oddsidemargin
  % \else\margin=\evensidemargin
  % \fi
  % \raisebox{\dimexpr -\topmargin-\headheight-\headsep-0.5\linewidth}[0pt][0pt]{%
  %   \rlap{\hspace{\dimexpr \margin+\textheight+\footskip - -1.0cm}%
  %   \llap{\rotatebox{90}{\thepage}}}}%
  %   \egroup\fi}
  % \AddEverypageHook{\Lpagenumber}
  
  \newcommand{\Lpagenumber}{
  \bgroup % Begin a local group to contain settings
  \dimendef\margin=0 % Use \margin instead of \dimen0
  \ifodd\value{page} % Check if the page number is odd
    \margin=\oddsidemargin
  \else
    \margin=\evensidemargin
  \fi
  \raisebox{\dimexpr -\topmargin-\headheight-\headsep-0.3\linewidth}[0pt][0pt]{%
    \rlap{\hspace{\dimexpr \margin+\textheight+\footskip - 0cm}%
    \llap{\rotatebox{90}{\thepage}}}}% Adjust position as needed
  \egroup % End the local group
}
\AddEverypageHook{\Lpagenumber}


  
  % \newgeometry{left=1cm, right=1cm, top=1.5cm, bottom=1.5cm}
}


% \fancypagestyle{landscapeplain}{
%   \fancyhf{} % Clear all headers and footers
%   \newgeometry{left=2cm, right=2cm, top=2cm, bottom=2cm} % Set reduced margins
%   \landscape
%   \fancyhead[L]{ % Left header
%     \begin{minipage}[c]{2.5cm} % Logo box, changed alignment to center (c)
%       \includegraphics[width=2.5cm]{suport/logo.png} % Adjust path as necessary
%     \end{minipage}
%     \hspace*{0.3cm}% Space between logo and vertical line
%     {\color{dark}\vrule width 0.5pt}% Vertical line
%     \hspace*{0.3cm}
%     \begin{minipage}[c]{11cm}
%       \definecolor{dark}{HTML}{000000}
%       {\normalsize\playfair\color{dark} Assurance of Learning} \\
%       {\small\normalfont\bfseries\color{dark} 2022/2023}
%     \end{minipage}
%   }
%   \fancyfoot[C]{\thepage} % Center footer with page number
% }



% left align title
\makeatletter
\renewcommand{\maketitle}{
  \thispagestyle{empty}
  \begin{tikzpicture}[remember picture,overlay]
    \node[inner sep=0pt] at (current page.center) {
      \includegraphics[width=\paperwidth,height=\paperheight]{suport/background.png} % replace 'background.jpg' with your actual image file
    };
    \node[text=black,font=\playfair\Huge,align=center] at ([yshift=-0.5cm]current page.center) { % shift the title and subtitle up by 1cm
      {\fontsize{46}{32}\selectfont \@title} \\[1ex] % title with reduced size
      {\fontsize{32}{24}\selectfont \@subtitle} \\[0.5ex] % subtitle with increased size
      {\Large\selectfont \@date} % date in dd/mm/yyyy format
    };
  \end{tikzpicture}
}
\makeatother




