% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}
\usepackage{graphicx}
\usepackage{ragged2e}
\usepackage{tikz}
\usepackage{wallpaper}
\usepackage{pdflscape} % For landscape orientation

% Set page size with a wider right margin
\geometry{a4paper, total={170mm,257mm}, left=20mm, top=25mm, bottom=20mm, right=20mm}

%% Let's define some colours
\definecolor{light}{HTML}{033F85}
\definecolor{highlight}{HTML}{E42313}
\definecolor{dark}{HTML}{000000}
\definecolor{titlecolor}{HTML}{000000}

%% Use some custom fonts
\setsansfont{OpenSans}[
  Path=suport/Open/,
  Scale=0.9,
  Extension = .ttf,
  UprightFont=*-Regular,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
]

\setmainfont{OpenSans}[
  Path=suport/Open/,
  Scale=0.9,
  Extension = .ttf,
  UprightFont=*-Regular,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  Color=textcolor,
]

\newfontfamily\playfair{PlayfairDisplay}[
  Path=suport/PlayfairDisplay/,
  Scale=0.9,
  Extension = .ttf,
  UprightFont=*-Regular,
  BoldFont=*-Bold,
  ItalicFont=*-Italic,
  Color=titlecolor,
]

%% style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{16}{16.8}\playfair} % reduced size
\sectionfont{\color{dark}\fontsize{14}{14.8}\playfair} % changed color to textcolor
\subsectionfont{\color{dark}\fontsize{12}{12.8}\playfair} % changed color to textcolor
\subsubsectionfont{\color{dark}\fontsize{11}{11.8}\playfair} % changed color to textcolor

% Numbering depth for sections and subsections
\setcounter{secnumdepth}{3}

%% Add a header with logo and text for portrait orientation
\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \lhead{\begin{minipage}[c]{2.5cm} % logo box
    \includegraphics[width=2.5cm]{suport/logo.png} % your logo path
  \end{minipage}
  \hspace*{0.3cm}% space between logo and vertical line
  {\color{dark}\vrule width 0.5pt}% vertical line
  \hspace*{0.3cm}
  \begin{minipage}[c]{11cm}
    \definecolor{dark}{HTML}{000000}
    {\normalsize\playfair\color{dark} Assurance of Learning} \\
    {\small\normalfont\bfseries\color{dark} 2022/2023}
  \end{minipage}
  \vspace*{0.1cm}
}
\definecolor{textcolor}{HTML}{383838}
  \fancyfoot[C]{\color{dark}\thepage}
  \fancyfootoffset{-0.5cm}
  \setlength{\footskip}{20pt}
}

% Define a new page style for landscape orientation
\fancypagestyle{landscapeplain}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \lhead{\begin{minipage}[c]{2.5cm} % logo box
    \includegraphics[width=2.5cm]{suport/logo.png}
  \end{minipage}
  \hspace*{0.3cm}% space between logo and vertical line
  {\color{dark}\vrule width 0.5pt}% vertical line
  \hspace*{0.3cm}
  \begin{minipage}[c]{14cm} % Adjusted to fit landscape orientation
    \definecolor{dark}{HTML}{000000}
    {\normalsize\playfair\color{dark} Assurance of Learning} \\
    {\small\normalfont\bfseries\color{dark} 2022/2023}
  \end{minipage}
  \vspace*{0.1cm}
}
\definecolor{textcolor}{HTML}{383838}
  \fancyfoot[C]{\color{dark}\thepage}
  \fancyfootoffset{-0.5cm}
  \setlength{\footskip}{20pt}
  \landscape
}

% Adjust title page for landscape
\makeatletter
\renewcommand{\maketitle}{
  \thispagestyle{empty}
  \begin{tikzpicture}[remember picture,overlay]
    \node[inner sep=0pt] at (current page.center) {
      \includegraphics[width=\paperwidth,height=\paperheight]{suport/background.png} % your background image path
    };
    \node[text=black,font=\playfair\Huge,align=center] at ([yshift=-0.5cm]current page.center) { % shift the title and subtitle up by 1cm
      {\fontsize{46}{32}\selectfont \@title} \\[1ex] % title with reduced size
      {\fontsize{32}{24}\selectfont \@subtitle} \\[0.5ex] % subtitle with increased size
      {\Large\selectfont \@date} % date in dd/mm/yyyy format
    };
  \end{tikzpicture}
}
\makeatother
